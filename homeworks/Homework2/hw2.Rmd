---
title: "Домашно 2 по Вероятности и Статистика"
author: "Георги Божинов 81333 курс 3 група 1"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

## Задача 1

```{r, message=FALSE}
library(UsingR)
attach(homedata)
```
Избираме 50 наблюдения, започващи от индекс 33*50.
```{r}
idx <- 33*50
data <- homedata[seq(from=idx, to=idx+50),]
```
Първо ще проверим дали данните са нормално разпределени, за да разберем дали да ползваме t.test или wilcox.test. 
```{r}
qqnorm(data$y1970)
qqline(data$y1970)
```
По графиката изглеждат такива. Да видим какво казва shapiro.test
```{r}
shapiro.test(data$y1970)
```
Голямо p-value. Не можем да отхвърлим хипотезата, че са нормални. Ще използваме t.test, за да направим доверителен интервал за данните. 
```{r}
res <- t.test(data$y1970, conf.level = 0.97)
res$conf.int
```
Това ни е доверителния интервал за цените през 1970. Сега същото за 2000.
```{r}
qqnorm(data$y2000)
qqline(data$y2000)
```
Тук има съмнение, поне визуално, че не са нормално разпределени. Да видим shapiro. 
```{r}
shapiro.test(data$y2000)
```
Малко p-value. Отхвърляме хипотезата, че са нормални. Ще ползваме wilcox.test
```{r}
res <- wilcox.test(data$y2000, conf.int = T, conf.level = 0.97)
res$conf.int
```
За промяната в цената ползваме wilcox теста, тъй като данните от 2000-ната година не са нормално разпределени.
```{r}
wilcox.test(data$y1970, data$y2000, paired = T)
```
p-value ни е доста малко. Отхвърляме хипотезата, че цената на жилищата не се е променила.

## Задача 2
```{r}
rain <- c(8.9, 6.4, 12.8, 9.6, 13.8, 16.1, 12.4, 12.8, 11.8, 16.0, 7.4, 12.5)
cotton <- c(306.2, 272.5, 385.0, 392.5, 400.0, 531.2, 415.0, 407.5, 373.7, 493.7, 325.0, 400.0)
```
Да направим линеен модел на данните.
```{r}
l <- lm(cotton ~ rain)
plot(rain, cotton)
abline(l)
```
Да видим summary на l.
```{r}
summary(l)
```
Моделът ни изглежда да е нещо от рода на Y = 21.57X + 139.31. Коефициентът пред X не изглежда да е нула. ( X = rain, Y = cotton ). За да намерим стойността за валежи Y + 5 ще използваме predict. ( в моя случай Y + 5 = 8)
```{r}
predict(l, data.frame(rain=c(8)))
```
Сега да predict-нем стойностите на +1 за всички валежи и да направим нов линеен модел за тях.
```{r}
new_rain <- rain + 1
new_cotton <- predict(l, data.frame(rain=new_rain))

l2 <- lm(new_cotton ~ rain)
coef(l2)
```
Виждаме, че коефициентът пред предиктора остава същия, а свободния член е 160, с около 21 по-голям от предишния. Тоест не можем да твърдим, че с поне 24 се увеличава реколтата.

П.П. Пробвах с модел, който добавя и rain ^ 2, но не се подобри особено.

## Задача 3

Да видим разпределението на данните:
```{r}
X <- c(39, 50, 61, 67, 40, 40, 54)
qqnorm(X)
qqline(X)

shapiro.test(X)
```
И тестът, и графиката ни казват, че не можем да отхвърлим, че данните са нормални. Сега същото за другите печки. 
```{r}
Y <- c(60, 53, 42, 41, 40, 54, 63, 69)
Y <- c(60, 53, 42, 41, 54, 63, 69)
qqnorm(Y)
qqline(Y)

shapiro.test(Y)
```
Същата работа. Значи можем да ползваме t.test за сравнението, с едностранна алтернатива. Също казваме, че данните са сдвоени ( наблюдения върху едно и също събитие ). 40 изглежда като outlier, махаме го, за да сработи теста, тъй като данните за Y са с едно повече. 
```{r}
t.test(X, Y, alternative = 'greater', paired = T)
```
Голямо p-value, приемаме хипотезата. Следователно, не можем да приемем за вярно твърдението, че изделията на X загряват по-бързо.

## Задача 4 

Тук ще направим хи-квадрат тест за независимост на следните случайните величини: хора работили в офиси, изолирани с азбест и имащи рак на белия дроб, и тези, които не са работили в офиси, изолирани с азбест. Таблицата ни изглежда по следния начин:

| Офис          | Общо          |
| ------------- |:-------------:|
| Да: 12        | Да: 36        |
| Не: 508       | Не: 4444      |
```{r}
X <- c(12, 36)
Y <- c(508, 4444)

chisq.test(data.frame(X, Y))
```
Малко p-value. Приемаме алтернативата, тоест появата на рак се влияе от съдържанието на азбест в работната среда.

## Задача 5

```{r}
A <- rexp(100, 1/4)
B <- rexp(100, 1/4)

C <- A / (A + B)
```
Преброяваме колко попадат в дадените интервали.
table функцията директно ни казва това.
```{r}
table(cut(C, c(0, 0.25, 0.5, 0.75, 1)))
```

Хистограмата:
```{r}
hist(C, breaks = c(0, 0.25, 0.5, 0.75, 1))
```

Дали е равномерно разпределено в [0, 1]? 
Тук имаме непрекъсната случайна величина, така че хи-квадрат теста не работи, явно. 
След малко research, намерих тест на Kolmogorov-Smirnov - goodness of fit - дали данните
идват от дадено разпределение?
Даваме му функция на разпределение и интервал на очакваното разпределение,
което да сравнява с реалните ни данни.
```{r}
ks.test(C, "punif", 0, 1)
```
P-value-то не е малко, не можем да отречем хипотезата, че са равномерно разпределени в [0, 1]